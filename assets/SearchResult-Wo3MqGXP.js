import{g as W,u as N,h as X,i as Z,j as ee,t as oe,k as te,l as q,m as E,n as e,p as ae,w as le,s as re,R as $,q as se,v as me,x as ge,y as he,z as ce,A as I,B as T,C as ne,D as ie,E as pe,F as ue,L as de,G as ve,H as ke,I as xe,J as j,K as we,M as f}from"./app-CkIn15Nq.js";const be=["/","/blogs-main/","/excerpts/","/pages-other/","/blogs-main/asio/1-asio.html","/blogs-main/asio/10-asio.html","/blogs-main/asio/11-asio.html","/blogs-main/asio/12-asio.html","/blogs-main/asio/13-asio.html","/blogs-main/asio/14-asio.html","/blogs-main/asio/15-asio.html","/blogs-main/asio/16-asio.html","/blogs-main/asio/17-asio.html","/blogs-main/asio/18-asio.html","/blogs-main/asio/19-asio.html","/blogs-main/asio/2-asio.html","/blogs-main/asio/20-asio.html","/blogs-main/asio/3-asio.html","/blogs-main/asio/4-asio.html","/blogs-main/asio/5-asio.html","/blogs-main/asio/6-asio.html","/blogs-main/asio/7-asio.html","/blogs-main/asio/8-asio.html","/blogs-main/asio/9-asio.html","/blogs-main/concurrent/01-con.html","/blogs-main/concurrent/02-con.html","/blogs-main/concurrent/03-con.html","/blogs-main/concurrent/04-con.html","/blogs-main/concurrent/05-con.html","/blogs-main/concurrent/06-con.html","/blogs-main/concurrent/07-con.html","/blogs-main/concurrent/08-con.html","/blogs-main/concurrent/09-con.html","/blogs-main/concurrent/10-con.html","/blogs-main/concurrent/11-con.html","/blogs-main/concurrent/12-con.html","/blogs-main/cpp/01-cpp.html","/blogs-main/cpp/02-cpp.html","/blogs-main/cpp/03-cpp.html","/blogs-main/cpp/04-cpp.html","/blogs-main/cpp/05-cpp.html","/blogs-main/golang/01-go.html","/blogs-main/golang/02-go.html","/blogs-main/golang/03-go.html","/blogs-main/golang/04-go.html","/blogs-main/golang/05-go.html","/blogs-main/golang/06-go.html","/blogs-main/golang/07-go.html","/blogs-main/golang/08-go.html","/blogs-main/golang/09-go.html","/blogs-main/golang/10-go.html","/blogs-main/golang/11-go.html","/blogs-main/golang/12-go.html","/blogs-main/golang/13-go.html","/blogs-main/golang/14-go.html","/blogs-main/golang/15-go.html","/blogs-main/golang/16-go.html","/blogs-main/golang/17-go.html","/blogs-main/golang/18-go.html","/excerpts/golang-program/00-golang-program.html","/excerpts/golang-program/01-golang-program.html","/excerpts/golang-program/02-golang-program.html","/excerpts/golang-program/03-golang-program.html","/excerpts/golang-program/04-golang-program.html","/excerpts/golang-program/05-golang-program.html","/excerpts/golang-program/06-golang-program.html","/excerpts/golang-program/07-golang-program.html","/excerpts/golang-program/08-golang-program.html","/excerpts/golang-program/09-golang-program.html","/excerpts/golang-program/10-golang-program.html","/excerpts/golang-program/11-golang-program.html","/excerpts/golang-program/12-golang-program.html","/excerpts/golang-program/13-golang-program.html","/excerpts/golang-teach/01-golang-teach.html","/excerpts/golang-teach/02-golang-teach.html","/excerpts/golang-teach/03-golang-teach.html","/excerpts/golang-teach/04-golang-teach.html","/excerpts/golang-teach/05-golang-teach.html","/excerpts/golang-teach/06-golang-teach.html","/excerpts/golang-teach/07-golang-teach.html","/excerpts/golang-teach/08-golang-teach.html","/excerpts/golang-teach/09-golang-teach.html","/excerpts/golang-teach/10-golang-teach.html","/excerpts/golang-teach/11-golang-teach.html","/excerpts/golang-teach/12-golang-teach.html","/excerpts/golang-teach/13-golang-teach.html","/excerpts/golang-teach/14-golang-teach.html","/excerpts/golang-teach/15-golang-teach.html","/excerpts/golang-teach/16-golang-teach.html","/excerpts/golang-teach/17-golang-teach.html","/excerpts/golang-teach/18-golang-teach.html","/excerpts/golang-teach/19-golang-teach.html","/excerpts/golang-teach/20-golang-teach.html","/excerpts/golang-teach/21-golang-teach.html","/excerpts/golang-teach/22-golang-teach.html","/excerpts/golang-teach/23-golang-teach.html","/excerpts/golang-teach/24-golang-teach.html","/excerpts/work-method/01-work-method.html","/excerpts/work-method/02-work-method.html","/excerpts/work-method/03-work-method.html","/excerpts/work-method/04-work-method.html","/excerpts/work-method/05-work-method.html","/excerpts/work-method/06-work-method.html","/excerpts/work-method/07-work-method.html","/excerpts/work-method/08-work-method.html","/excerpts/work-method/09-work-method.html","/excerpts/work-method/10-work-method.html","/excerpts/work-method/11-work-method.html","/excerpts/work-method/12-work-method.html","/excerpts/work-method/13-work-mehod.html","/excerpts/work-method/14-work-method.html","/excerpts/work-method/15-work-method.html","/excerpts/work-method/16-work-method.html","/excerpts/work-method/17-work-method.html","/excerpts/work-method/18-work-method.html","/excerpts/work-method/19-work-method.html","/excerpts/work-method/20-work-method.html","/excerpts/work-method/21-work-method.html","/excerpts/work-method/22-work-method.html","/excerpts/work-method/23-work-method.html","/excerpts/work-method/24-work-method.html","/excerpts/work-method/25-work-method.html","/excerpts/work-method/26-work-method.html","/excerpts/work-method/27-work-method.html","/excerpts/work-method/28-work-method.html","/excerpts/work-method/29-work-method.html","/excerpts/work-method/30-work-method.html","/excerpts/work-method/31-work-method.html","/excerpts/work-method/32-work-method.html","/excerpts/work-method/33-work-method.html","/excerpts/work-method/34-work-method.html","/excerpts/work-method/35-work-method.html","/excerpts/work-method/36-work-method.html","/excerpts/work-method/37-work-method.html","/excerpts/work-method/38-work-method.html","/excerpts/work-method/39-work-method.html","/excerpts/work-method/40-work-method.html","/excerpts/work-method/41-work-method.html","/pages-other/bug-fix/bug1.html","/pages-other/mystore/01-sse.html","/pages-other/mystore/02-docker.html","/pages-other/mystore/03-gin.html","/pages-other/mystore/04-uber.html","/pages-other/mystore/05-rabbitmq.html","/404.html","/blogs-main/asio/","/blogs-main/concurrent/","/blogs-main/cpp/","/blogs-main/golang/","/excerpts/golang-program/","/excerpts/golang-teach/","/excerpts/work-method/","/pages-other/bug-fix/","/pages-other/mystore/","/pages-other/week-once/","/category/","/category/%E7%BD%91%E7%BB%9C/","/category/%E5%B9%B6%E5%8F%91/","/category/%E8%AF%AD%E8%A8%80/","/category/%E6%91%98%E5%BD%95/","/category/bug-fix/","/category/%E6%9D%82%E8%B4%A7%E9%93%BA/","/tag/","/tag/asio/","/tag/cpp/","/tag/golang/","/tag/go-%E8%AF%AD%E8%A8%80%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/","/tag/22-%E8%AE%B2%E9%80%9A%E5%85%B3-go-%E8%AF%AD%E8%A8%80/","/tag/%E7%A8%8B%E5%BA%8F%E5%91%98%E5%B7%A5%E4%BD%9C%E6%B3%95/","/tag/bug/","/tag/mystore/","/article/","/star/","/timeline/"],ye="SLIMSEARCH_QUERY_HISTORY",k=j(ye,[]),Ee=()=>{const{queryHistoryCount:l}=f;return{enabled:l>0,queryHistories:k,addQueryHistory:g=>{k.value=Array.from(new Set([g,...k.value.slice(0,l-1)]))},removeQueryHistory:g=>{k.value=[...k.value.slice(0,g),...k.value.slice(g+1)]}}},C=l=>be[l.id]+("anchor"in l?`#${l.anchor}`:""),fe="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:M}=f,x=j(fe,[]),Ae=()=>({enabled:M>0,resultHistories:x,addResultHistory:m=>{{const g={link:C(m),display:m.display};"header"in m&&(g.header=m.header),x.value=[g,...x.value.slice(0,M-1)]}},removeResultHistory:m=>{x.value=[...x.value.slice(0,m),...x.value.slice(m+1)]}}),He=l=>{const{page:m,routeLocale:g}=ne(),A=ie(),r=q(0),w=E(()=>r.value>0),n=pe([]);return ue(()=>{const{search:H,terminate:u}=de(),b=ke(d=>{const{resultsFilter:B=a=>a,querySplitter:v,suggestionsFilter:S,...s}=A.value;d?(r.value+=1,H(d,g.value,s).then(a=>B(a,d,g.value,m.value)).then(a=>{r.value-=1,n.value=a}).catch(a=>{console.warn(a),r.value-=1,r.value||(n.value=[])})):n.value=[]},f.searchDelay-f.suggestDelay,{maxWait:5e3});ve([l,g],([d])=>b(d.join(" "))),xe(()=>{u()})}),{isSearching:w,results:n}};var Re=W({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(l,{emit:m}){const g=N(),A=X(),r=Z(ee),{addQueryHistory:w,queryHistories:n,removeQueryHistory:H}=Ee(),{resultHistories:u,addResultHistory:b,removeResultHistory:d}=Ae(),B=oe(l,"queries"),{results:v,isSearching:S}=He(B),s=te({isQuery:!0,index:0}),a=q(0),i=q(0),F=E(()=>n.value.length>0||u.value.length>0),R=E(()=>v.value.length>0),D=E(()=>v.value[a.value]||null),U=()=>{const{isQuery:o,index:t}=s;t===0?(s.isQuery=!o,s.index=o?u.value.length-1:n.value.length-1):s.index=t-1},_=()=>{const{isQuery:o,index:t}=s;t===(o?n.value.length-1:u.value.length-1)?(s.isQuery=!o,s.index=0):s.index=t+1},O=()=>{a.value=a.value>0?a.value-1:v.value.length-1,i.value=D.value.contents.length-1},P=()=>{a.value=a.value<v.value.length-1?a.value+1:0,i.value=0},Y=()=>{i.value<D.value.contents.length-1?i.value+=1:P()},z=()=>{i.value>0?i.value-=1:O()},Q=o=>o.map(t=>we(t)?t:e(t[0],t[1])),G=o=>{if(o.type==="customField"){const t=he[o.index]||"$content",[p,h=""]=ce(t)?t[A.value].split("$content"):t.split("$content");return o.display.map(c=>e("div",Q([p,...c,h])))}return o.display.map(t=>e("div",Q(t)))},y=()=>{a.value=0,i.value=0,m("updateQuery",""),m("close")},J=()=>e("div",{class:"slimsearch-records"},e("div",{class:"slimsearch-record"},[e("div",{class:"slimsearch-record-title"},r.value.queryHistory),e("ul",{class:"slimsearch-record-contents",role:"listbox"},n.value.map((o,t)=>{const p=s.isQuery&&s.index===t;return e("li",{class:["slimsearch-record-matches",{active:p}],role:"option","aria-selected":p,onClick:()=>{m("updateQuery",o)}},e("div",[e(I,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},o),e("button",{type:"button",class:"slimsearch-remove-icon",title:r.value.remove,"aria-label":r.value.remove,innerHTML:T,onClick:h=>{h.preventDefault(),h.stopPropagation(),H(t)}})]))}))])),K=()=>e("ul",{class:"slimsearch-records"},e("li",{class:"slimsearch-record"},[e("div",{class:"slimsearch-record-title"},r.value.resultHistory),e("ul",{class:"slimsearch-record-contents",role:"listbox"},u.value.map((o,t)=>{const p=!s.isQuery&&s.index===t;return e("li",{class:["slimsearch-record-matches",{active:p}],role:"option","aria-selected":p},e($,{to:o.link,onClick:()=>{y()}},()=>[e(I,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},[o.header?e("div",{class:"slimsearch-record-content-header"},o.header):null,e("div",o.display.map(h=>Q(h)).flat())]),e("button",{type:"button",class:"slimsearch-remove-icon",title:r.value.remove,"aria-label":r.value.remove,innerHTML:T,onClick:h=>{h.preventDefault(),h.stopPropagation(),d(t)}})]))}))]));return ae("keydown",o=>{if(l.isFocusing){if(R.value){if(o.key==="ArrowUp")z();else if(o.key==="ArrowDown")Y();else if(o.key==="Enter"){const t=D.value.contents[i.value];w(l.queries.join(" ")),b(t),g.push(C(t)),y()}}else if(o.key==="ArrowUp")U();else if(o.key==="ArrowDown")_();else if(o.key==="Enter"){const{index:t}=s;s.isQuery?(o.preventDefault(),m("updateQuery",n.value[t])):(g.push(u.value[t].link),y())}}}),le([a,i],()=>{document.querySelector(".slimsearch-record.active .slimsearch-record-matches.active")?.scrollIntoView(!1)},{flush:"post"}),()=>e("div",{id:"slimsearch-results",class:["slimsearch-result-wrapper",{empty:l.queries.length?!R.value:!F.value}]},l.queries.length?S.value?e(re,{hint:r.value.searching}):R.value?e("div",{class:"slimsearch-records",role:"listbox","aria-labeledby":"slimsearch-label"},v.value.map(({title:o,contents:t},p)=>{const h=a.value===p;return e("div",{class:["slimsearch-record",{active:h}],role:"group","aria-selected":h},[e("div",{class:"slimsearch-record-title"},o||r.value.defaultTitle),e("ul",{class:"slimsearch-record-contents"},t.map((c,V)=>{const L=h&&i.value===V;return e("li",{class:["slimsearch-record-matches",{active:L}],role:"option","aria-selected":L},e($,{to:C(c),onClick:()=>{w(l.queries.join(" ")),b(c),y()}},()=>[c.type==="text"?null:e(c.type==="title"?se:c.type==="heading"?me:ge,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},[c.type==="text"&&c.header?e("div",{class:"slimsearch-record-content-header"},c.header):null,e("div",G(c))])]))}))])})):r.value.emptyResult:F.value?[J(),K()]:r.value.emptyHistory)}});export{Re as default};
